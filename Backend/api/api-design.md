# API Design

## RESTful API ì„¤ê³„ ì›ì¹™

> REST(Representational State Transfer) ì•„í‚¤í…ì²˜ ìŠ¤íƒ€ì¼ì„ ë”°ë¥´ëŠ” API ì„¤ê³„

---

## URL ì„¤ê³„

### ê¸°ë³¸ ê·œì¹™

```
# ë¦¬ì†ŒìŠ¤ëŠ” ëª…ì‚¬, ë³µìˆ˜í˜• ì‚¬ìš©
âœ… GET /users
âœ… GET /users/123
âœ… GET /users/123/orders

# ë™ì‚¬ ì‚¬ìš© ê¸ˆì§€
âŒ GET /getUsers
âŒ POST /createUser
âŒ DELETE /deleteUser/123
```

### ê³„ì¸µ ê´€ê³„

```
# ë¶€ëª¨-ìì‹ ê´€ê³„
GET /users/123/orders          # ì‚¬ìš©ìì˜ ì£¼ë¬¸ ëª©ë¡
GET /users/123/orders/456      # íŠ¹ì • ì£¼ë¬¸

# 3ë‹¨ê³„ ì´ìƒ ì¤‘ì²© í”¼í•˜ê¸°
âŒ /users/123/orders/456/items/789/reviews
âœ… /order-items/789/reviews
```

---

## HTTP ë©”ì„œë“œ

| ë©”ì„œë“œ   | ìš©ë„      | ë©±ë“±ì„± | ì•ˆì „ |
| -------- | --------- | :----: | :--: |
| `GET`    | ì¡°íšŒ      |   âœ…   |  âœ…  |
| `POST`   | ìƒì„±      |   âŒ   |  âŒ  |
| `PUT`    | ì „ì²´ ìˆ˜ì • |   âœ…   |  âŒ  |
| `PATCH`  | ë¶€ë¶„ ìˆ˜ì • |   âŒ   |  âŒ  |
| `DELETE` | ì‚­ì œ      |   âœ…   |  âŒ  |

### ì‚¬ìš© ì˜ˆì‹œ

```bash
GET    /users          # ëª©ë¡ ì¡°íšŒ
POST   /users          # ìƒì„±
GET    /users/123      # ë‹¨ê±´ ì¡°íšŒ
PUT    /users/123      # ì „ì²´ ìˆ˜ì •
PATCH  /users/123      # ë¶€ë¶„ ìˆ˜ì •
DELETE /users/123      # ì‚­ì œ
```

---

## ìƒíƒœ ì½”ë“œ

### ì„±ê³µ (2xx)

| ì½”ë“œ  | ì˜ë¯¸       | ì‚¬ìš©                       |
| ----- | ---------- | -------------------------- |
| `200` | OK         | ì¡°íšŒ/ìˆ˜ì • ì„±ê³µ             |
| `201` | Created    | ìƒì„± ì„±ê³µ                  |
| `204` | No Content | ì‚­ì œ ì„±ê³µ (ì‘ë‹µ ë³¸ë¬¸ ì—†ìŒ) |

### í´ë¼ì´ì–¸íŠ¸ ì—ëŸ¬ (4xx)

| ì½”ë“œ  | ì˜ë¯¸                 | ì‚¬ìš©                           |
| ----- | -------------------- | ------------------------------ |
| `400` | Bad Request          | ì˜ëª»ëœ ìš”ì²­ (ìœ íš¨ì„± ê²€ì¦ ì‹¤íŒ¨) |
| `401` | Unauthorized         | ì¸ì¦ í•„ìš”                      |
| `403` | Forbidden            | ê¶Œí•œ ì—†ìŒ                      |
| `404` | Not Found            | ë¦¬ì†ŒìŠ¤ ì—†ìŒ                    |
| `409` | Conflict             | ì¶©ëŒ (ì¤‘ë³µ ë“±)                 |
| `422` | Unprocessable Entity | ì²˜ë¦¬ ë¶ˆê°€ (ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì‹¤íŒ¨) |
| `429` | Too Many Requests    | ìš”ì²­ ì œí•œ ì´ˆê³¼                 |

### ì„œë²„ ì—ëŸ¬ (5xx)

| ì½”ë“œ  | ì˜ë¯¸                  | ì‚¬ìš©             |
| ----- | --------------------- | ---------------- |
| `500` | Internal Server Error | ì„œë²„ ë‚´ë¶€ ì˜¤ë¥˜   |
| `502` | Bad Gateway           | ê²Œì´íŠ¸ì›¨ì´ ì˜¤ë¥˜  |
| `503` | Service Unavailable   | ì„œë¹„ìŠ¤ ì´ìš© ë¶ˆê°€ |

---

## ì—ëŸ¬ ì‘ë‹µ í˜•ì‹

### í‘œì¤€ í˜•ì‹

```json
{
  "error": {
    "code": "USER_NOT_FOUND",
    "message": "ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤",
    "details": [
      {
        "field": "userId",
        "message": "ìœ íš¨í•˜ì§€ ì•Šì€ ì‚¬ìš©ì IDì…ë‹ˆë‹¤"
      }
    ]
  }
}
```

### ìœ íš¨ì„± ê²€ì¦ ì—ëŸ¬

```json
{
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "ì…ë ¥ê°’ì´ ìœ íš¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤",
    "details": [
      { "field": "email", "message": "ì´ë©”ì¼ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤" },
      { "field": "password", "message": "ë¹„ë°€ë²ˆí˜¸ëŠ” 8ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤" }
    ]
  }
}
```

---

## í˜ì´ì§€ë„¤ì´ì…˜

### Offset ê¸°ë°˜ (ë‹¨ìˆœ)

```
GET /users?page=2&limit=20

{
  "data": [...],
  "meta": {
    "page": 2,
    "limit": 20,
    "total": 100,
    "totalPages": 5
  }
}
```

### Cursor ê¸°ë°˜ (ëŒ€ê·œëª¨ ë°ì´í„°)

```
GET /users?cursor=abc123&limit=20

{
  "data": [...],
  "meta": {
    "nextCursor": "def456",
    "hasNext": true
  }
}
```

### ğŸ¯ í˜ì´ì§€ë„¤ì´ì…˜ ì„ íƒ ì²´í¬ë¦¬ìŠ¤íŠ¸

**Offset ê¸°ë°˜ ì„ íƒ**

- [ ] ì „ì²´ ê°œìˆ˜ê°€ í•„ìš” (total count)
- [ ] íŠ¹ì • í˜ì´ì§€ë¡œ ë°”ë¡œ ì´ë™ í•„ìš”
- [ ] ë°ì´í„° ê·œëª¨ê°€ ì‘ìŒ (< 10ë§Œ ê±´)
- [ ] ì‹¤ì‹œê°„ ë°ì´í„° ë³€ê²½ì´ ì ìŒ

**Cursor ê¸°ë°˜ ì„ íƒ**

- [ ] ëŒ€ê·œëª¨ ë°ì´í„° (> 10ë§Œ ê±´)
- [ ] ë¬´í•œ ìŠ¤í¬ë¡¤ UI
- [ ] ì‹¤ì‹œê°„ ë°ì´í„° ë³€ê²½ì´ ë§ìŒ
- [ ] ì„±ëŠ¥ì´ ì¤‘ìš”

---

## í•„í„°ë§ & ì •ë ¬

```bash
# í•„í„°ë§
GET /users?status=active&role=admin

# ì •ë ¬
GET /users?sort=createdAt:desc
GET /users?sort=-createdAt  # ë˜ëŠ” - ì ‘ë‘ì‚¬

# í•„ë“œ ì„ íƒ (Sparse Fieldset)
GET /users?fields=id,name,email

# ê²€ìƒ‰
GET /users?q=john
```

---

## API ë²„ì „ ê´€ë¦¬

### URL Path (ê¶Œì¥)

```
GET /api/v1/users
GET /api/v2/users
```

### Header

```
GET /api/users
Accept: application/vnd.api+json;version=1
```

### Query String

```
GET /api/users?version=1
```

### ğŸ¯ ë²„ì „ ê´€ë¦¬ ì„ íƒ ì²´í¬ë¦¬ìŠ¤íŠ¸

**URL Path ì„ íƒ**

- [ ] ëª…ì‹œì ì´ê³  ì§ê´€ì 
- [ ] ìºì‹±ì´ ìš©ì´í•´ì•¼ í•¨
- [ ] ë¸Œë¼ìš°ì €ì—ì„œ ì§ì ‘ í…ŒìŠ¤íŠ¸
- [ ] ëŒ€ë¶€ë¶„ì˜ ê²½ìš° (ê¶Œì¥)

**Header ì„ íƒ**

- [ ] URL ê¹”ë”í•˜ê²Œ ìœ ì§€
- [ ] í´ë¼ì´ì–¸íŠ¸ê°€ í—¤ë” ì„¤ì • ê°€ëŠ¥
- [ ] ë²„ì „ ì „í™˜ì´ ìœ ì—°í•´ì•¼ í•¨

---

## ì‘ë‹µ ë˜í•‘

### ì¼ê´€ëœ ì‘ë‹µ êµ¬ì¡°

```json
// ì„±ê³µ
{
  "success": true,
  "data": { ... },
  "meta": { ... }
}

// ì—ëŸ¬
{
  "success": false,
  "error": {
    "code": "...",
    "message": "..."
  }
}
```

### ë˜ëŠ” ë‹¨ìˆœ êµ¬ì¡°

```json
// ì„±ê³µ - ë°ì´í„° ì§ì ‘ ë°˜í™˜
{ "id": 1, "name": "John" }

// ì—ëŸ¬ - error ê°ì²´
{ "error": { ... } }
```

---

## ğŸ¯ API ì„¤ê³„ ì²´í¬ë¦¬ìŠ¤íŠ¸

### URL ì„¤ê³„

- [ ] ë¦¬ì†ŒìŠ¤ëŠ” ëª…ì‚¬, ë³µìˆ˜í˜•
- [ ] ë™ì‚¬ ì‚¬ìš© ì•ˆí•¨
- [ ] ì†Œë¬¸ì, í•˜ì´í”ˆ(-) ì‚¬ìš©
- [ ] 3ë‹¨ê³„ ì´ìƒ ì¤‘ì²© í”¼í•¨

### ì‘ë‹µ

- [ ] ì ì ˆí•œ HTTP ìƒíƒœ ì½”ë“œ
- [ ] ì¼ê´€ëœ ì—ëŸ¬ ì‘ë‹µ í˜•ì‹
- [ ] í˜ì´ì§€ë„¤ì´ì…˜ (ëª©ë¡ API)

### ë³´ì•ˆ

- [ ] HTTPS í•„ìˆ˜
- [ ] Rate Limiting
- [ ] ì¸ì¦/ì¸ê°€ ì ìš©

### ë¬¸ì„œí™”

- [ ] OpenAPI (Swagger) ë¬¸ì„œ
- [ ] ì˜ˆì‹œ ìš”ì²­/ì‘ë‹µ í¬í•¨
- [ ] ì—ëŸ¬ ì½”ë“œ ì •ì˜

---

## ì°¸ê³ 

- [Microsoft REST API Guidelines](https://github.com/microsoft/api-guidelines)
- [Google API Design Guide](https://cloud.google.com/apis/design)
